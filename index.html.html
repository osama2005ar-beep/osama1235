<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>النماذج الإدارية</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #0f1a35;
      color: #ffffffd3;
      direction: rtl;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
      padding-top: 50px;
    }
    @keyframes pulseGlow {
      0% { box-shadow: 0 0 0 #ffffff; }
      50% { box-shadow: 0 0 20px #ffffff; }
      100% { box-shadow: 0 0 0 #ffffff; }
    }
    input:hover, select:hover, textarea:hover, button:hover,
    input:focus, select:focus, textarea:focus, button:focus {
      border-color: #ffffff;
      animation: pulseGlow 0.6s ease;
      outline: none;
    }
    canvas#starfield {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: #0f1a35;
    }
    .custom-alert {
      position: fixed;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      padding: 20px 40px;
      border-radius: 15px;
      box-shadow: 0 6px 25px rgba(0, 0, 0, 0.5);
      opacity: 0;
      transform: translate(-50%, -20px);
      transition: all 0.4s ease-in-out;
      z-index: 99999;
      font-weight: bold;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .custom-alert.show {
      opacity: 1;
      transform: translate(-50%, 0);
    }
    .custom-alert.success {
      background-color: #28a745;
      color: white;
      border: 3px solid #218838;
      animation: successPulse 0.5s ease-in-out;
    }
    .custom-alert.error {
      background-color: #dc3545;
      color: white;
      border: 3px solid #c82333;
      animation: errorShake 0.4s ease-in-out;
    }
    @keyframes successPulse {
      0% { transform: translate(-50%, 0) scale(1); }
      50% { transform: translate(-50%, 0) scale(1.05); }
      100% { transform: translate(-50%, 0) scale(1); }
    }
    @keyframes errorShake {
      0%, 100% { transform: translate(-50%, 0); }
      25% { transform: translate(-50%, -5px); }
      50% { transform: translate(-50%, 5px); }
      75% { transform: translate(-50%, -3px); }
    }
    .image-gallery {
      position: fixed;
      top: 10px;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 25px;
      z-index: 9999;
    }
    .image-gallery img {
      width: 120px;
      height: 120px;
      object-fit: contain;
      border-radius: 15px;
      transition: transform 0.3s ease;
    }
    .image-gallery img:hover {
      transform: scale(1.05);
    }
    .main-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 1000px;
    }
    #formTypeContainer {
      width: 100%;
      max-width: 700px;
      text-align: center;
      margin-bottom: 15px;
      background: rgba(15, 26, 53, 0.9);
      padding: 30px;
      border: 3px solid rgba(255, 255, 255, 0.7);
      border-radius: 20px;
      box-shadow: 0 6px 20px rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(6px);
      display: block;
    }
    #formTypeContainer label {
      font-size: 1.3rem;
      font-weight: bold;
      margin-bottom: 15px;
      display: block;
    }
    #formTypeContainer select {
      width: 100%;
      padding: 15px;
      background: #02204d;
      color: #ffffff;
      border: 3px solid rgb(29, 28, 28);
      border-radius: 12px;
      font-size: 1.2rem;
    }
    .container {
      width: 100%;
      max-width: 1000px;
      background: rgba(15, 26, 53, 0.9);
      padding: 30px;
      border: 3px solid rgba(255, 255, 255, 0.7);
      border-radius: 20px;
      box-shadow: 0 6px 20px rgba(255, 255, 255, 0.4), 0 0 25px rgba(0, 0, 0, 0.6);
      animation: glow 3s ease-in-out infinite alternate;
      z-index: 1;
      display: none;
      overflow-y: auto;
      max-height: 80vh;
    }
    @keyframes glow {
      0% {
        box-shadow: 0 6px 20px rgba(255, 255, 255, 0.4), 0 0 25px rgba(0, 0, 0, 0.6);
      }
      100% {
        box-shadow: 0 8px 30px rgba(255, 255, 255, 0.6), 0 0 35px rgba(0, 0, 0, 0.7);
      }
    }
    h1 {
      text-align: center;
      font-size: 1.8rem;
      margin-bottom: 20px;
      font-weight: 800;
      letter-spacing: 2px;
      text-shadow: 0 0 6px rgb(255, 255, 255);
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
      font-size: 1.3rem;
    }
    input, select, textarea {
      width: 100%;
      padding: 15px;
      margin-top: 10px;
      border-radius: 12px;
      border: 3px solid rgb(29, 28, 28);
      background: #02204d;
      color: #ffffff;
      font-size: 1.2rem;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: #ffffff;
      box-shadow: 0 0 12px rgba(255, 255, 255, 0.9);
    }
    textarea {
      resize: vertical;
      height: 120px;
    }
    button {
      background-color: #ffffff;
      color: #02204d;
      font-weight: 900;
      border: none;
      padding: 18px 0;
      border-radius: 12px;
      cursor: pointer;
      font-size: 1.4rem;
      letter-spacing: 1.2px;
      box-shadow: 0 0 18px rgba(255, 255, 255, 0.9);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      margin-top: 20px;
      width: 100%;
    }
    button:hover {
      background-color: #e0e0e0;
      box-shadow: 0 0 25px rgba(255, 255, 255, 1);
    }
    .form-section {
      display: none;
    }
    .form-section.active {
      display: block;
    }
    .person-group {
      margin-bottom: 20px;
      border: 2px solid rgba(255, 255, 255, 0.5);
      padding: 15px;
      border-radius: 10px;
    }
    .remove-person {
      background-color: #dc3545;
      color: white;
      width: auto;
      padding: 5px 15px;
      margin-top: 10px;
    }
    .remove-person:hover {
      background-color: #c82333;
    }
    .add-person {
      background-color: #28a745;
      color: white;
      width: auto;
      padding: 5px 15px;
      margin-top: 10px;
    }
    .add-person:hover {
      background-color: #218838;
    }
    .note {
      color: #ffffff;
      font-size: 1.2rem;
      margin-top: 10px;
      font-style: italic;
      text-align: right;
    }
    #loadingOverlay {
      position: fixed;
      inset: 0;
      background: black;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 99999;
      opacity: 1;
      transition: opacity 1s ease;
      pointer-events: all;
    }
    #loadingOverlay.fade-out {
      opacity: 0;
      pointer-events: none;
    }
    .dual-fade-loader {
      position: relative;
      width: 100px;
      height: 100px;
    }
    .circle {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 6px solid white;
      opacity: 0;
      animation: fadePulse 1.4s infinite ease-in-out;
    }
    .circle:nth-child(2) {
      animation-delay: 0.7s;
      border-color: #ccc;
    }
    @keyframes fadePulse {
      0% { transform: scale(0.5); opacity: 0.3; }
      50% { transform: scale(1); opacity: 1; }
      100% { transform: scale(1.5); opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="image-gallery">
    <img src="https://www.raed.net/img?id=1413653" alt="Logo Left">
    <img src="https://www.raed.net/img?id=1413652" alt="Logo Right">
  </div>
  <canvas id="starfield"></canvas>
  <div id="loadingOverlay">
    <div class="dual-fade-loader">
      <div class="circle"></div>
      <div class="circle"></div>
    </div>
  </div>
  <div id="notification" class="custom-alert"></div>
  <div class="main-content">
    <div id="formTypeContainer">
      <label for="formType">برقيات القيادات</label>
      <select id="formType" onchange="toggleForm()">
        <option value="">نوع البرقية</option>
        <option value="promotion">ترقية</option>
        <option value="gse">توظيف الأمن العام</option>
        <option value="admin">تعيين إداري</option>
        <option value="military">تعيين عسكري</option>
        <option value="authorized">تعيين معتمد</option>
        <option value="reassignment">إعادة الخدمة</option>
      </select>
    </div>
    <div class="container" id="container">
      <h1>برقيات القيادة</h1>
      <label for="issuer">اختر القائد:</label>
      <select id="issuer">
        <option value="">اختر قائد</option>
        <option value="شامان القحطاني|<@1276531558798327859>||<@&1271924904593330267>|<@&1271924904572227600> <@1276531558798327859>">شامان القحطاني</option>
        <option value="هيثم الشمري|<@725655535172714608>||<@&1271924904572227603>|<@&1271924904572227598> <@725655535172714608>">هيثم الشمري</option>
        <option value="رياض الحربي|<@1226723195168493620>||<@&1271924904572227602>|<@&1271924904572227598> <@1226723195168493620>">رياض الحربي</option>
        <option value="باسل الشمري|<@1199056662640738375>||<@&1271924904572227602>|<@&1271924904572227596> <@1199056662640738375>">باسل الشمري</option>
        <option value="محمد الجهني|<@1041025088813813810>||<@&1271924904572227602>|<@&1271924904572227596> <@1041025088813813810>">محمد الجهني</option>
        <option value="مسند بن حمد|<@1125795366588121108>||<@&1271924904572227601>|<@&1271924904572227594> <@1125795366588121108>">مسند بن حمد</option>
        <option value="متعب الزهراني|<@1187076971931381836>||<@&1271924904572227601>|<@&1271924904572227594> <@1187076971931381836>">متعب الزهراني</option>
      </select>
      <div id="promotion" class="form-section">
        <label for="telegramNumber0">رقم البرقية:</label>
        <input type="text" id="telegramNumber0" placeholder="أدخل رقم البرقية">
        <label for="promotionType0">نوع الترقية:</label>
        <input type="text" id="promotionType0" placeholder="أدخل نوع الترقية مثل: الترقيات المستحقة">
        <div class="person-group" id="personGroup0">
          <label for="userIds0_0">كوبي ايدي العسكري</label>
          <textarea id="userIds0_0" placeholder="ID"></textarea>
          <label for="rankOld0_0">الرتبة السابقة:</label>
          <select id="rankOld0_0">
            <option value="">اختر رتبة</option>
            <option value="<@&1271924904509444211>">جندي</option>
            <option value="<@&1271924904509444212> <:gdgd:1329942751160307842>">جندي أول</option>
            <option value="<@&1271924904509444213> <:ggd:1329942772798722058>">عريف</option>
            <option value="<@&1271924904509444214> <:rere:1329942787248099374>">وكيل رقيب</option>
            <option value="<@&1271924904509444215> <:rq:1329942811054964759>">رقيب</option>
            <option value="<@&1271924904509444216> <:qwdq:1329942825038778498>">رقيب أول</option>
            <option value="<@&1271924904530542735> <:jjj:1329944131224735804>">رئيس رقباء</option>
            <option value="<@&1271924904530542736> <:ggy:1329944091873640520>">ملازم</option>
            <option value="<@&1271924904530542737> <:hnn:1329944105861513226>">ملازم أول</option>
            <option value="<@&1271924904530542738> <:N_:1329942837856305252>">نقيب</option>
            <option value="<@&1271924904530542739> <:K_:1329942847893409925>">رائد</option>
            <option value="<@&1271924904530542741> <:D_:1329942880122437642>">مقدم</option>
            <option value="<@&1271924904530542743> <:jju:1329944115667931136>">عقيد</option>
            <option value="<@&1271924904572227594> <:G_:1329942871331045406>">عميد</option>
            <option value="<@&1271924904572227596> <:D_:1329942880122437642>">لواء</option>
            <option value="<@&1271924904572227598> <:S_:1329942890784493675>">فريق</option>
            <option value="<@&1271924904572227600> <:A_:1329942900976390165>">فريق أول</option>
          </select>
          <label for="rankNew0_0">الرتبة الجديدة:</label>
          <select id="rankNew0_0">
            <option value="">اختر رتبة</option>
            <option value="<@&1271924904509444211>">جندي</option>
            <option value="<@&1271924904509444212> <:gdgd:1329942751160307842>">جندي أول</option>
            <option value="<@&1271924904509444213> <:ggd:1329942772798722058>">عريف</option>
            <option value="<@&1271924904509444214> <:rere:1329942787248099374>">وكيل رقيب</option>
            <option value="<@&1271924904509444215> <:rq:1329942811054964759>">رقيب</option>
            <option value="<@&1271924904509444216> <:qwdq:1329942825038778498>">رقيب أول</option>
            <option value="<@&1271924904530542735> <:jjj:1329944131224735804>">رئيس رقباء</option>
            <option value="<@&1271924904530542736> <:ggy:1329944091873640520>">ملازم</option>
            <option value="<@&1271924904530542737> <:hnn:1329944105861513226>">ملازم أول</option>
            <option value="<@&1271924904530542738> <:N_:1329942837856305252>">نقيب</option>
            <option value="<@&1271924904530542739> <:K_:1329942847893409925>">رائد</option>
            <option value="<@&1271924904530542741> <:D_:1329942880122437642>">مقدم</option>
            <option value="<@&1271924904530542743> <:jju:1329944115667931136>">عقيد</option>
            <option value="<@&1271924904572227594> <:G_:1329942871331045406>">عميد</option>
            <option value="<@&1271924904572227596> <:D_:1329942880122437642>">لواء</option>
            <option value="<@&1271924904572227598> <:S_:1329942890784493675>">فريق</option>
            <option value="<@&1271924904572227600> <:A_:1329942900976390165>">فريق أول</option>
          </select>
        </div>
        <button class="add-person" onclick="addPerson()">إضافة شخص آخر</button>
      </div>
      <div id="gse" class="form-section">
        <label for="telegramNumberGSE0">رقم البرقية:</label>
        <input type="text" id="telegramNumberGSE0" placeholder="أدخل رقم البرقية">
        <label for="batchNumber0">رقم الدفعة:</label>
        <input type="text" id="batchNumber0" placeholder="أدخل رقم الدفعة">
        <label for="userIdsGSE0">كوبي ايدي العسكري</label>
        <textarea id="userIdsGSE0" placeholder="ID"></textarea>
        <label for="rankGSE0">الرتبة:</label>
        <select id="rankGSE0">
          <option value="">اختر رتبة</option>
          <option value="<@&1271924904509444211>">جندي</option>
          <option value="<@&1271924904509444212> <:gdgd:1329942751160307842>">جندي أول</option>
          <option value="<@&1271924904509444213> <:ggd:1329942772798722058>">عريف</option>
          <option value="<@&1271924904509444214> <:rere:1329942787248099374>">وكيل رقيب</option>
          <option value="<@&1271924904509444215> <:rq:1329942811054964759>">رقيب</option>
          <option value="<@&1271924904509444216> <:qwdq:1329942825038778498>">رقيب أول</option>
          <option value="<@&1271924904530542735> <:jjj:1329944131224735804>">رئيس رقباء</option>
          <option value="<@&1271924904530542736> <:ggy:1329944091873640520>">ملازم</option>
          <option value="<@&1271924904530542737> <:hnn:1329944105861513226>">ملازم أول</option>
          <option value="<@&1271924904530542738> <:N_:1329942837856305252>">نقيب</option>
          <option value="<@&1271924904530542739> <:K_:1329942847893409925>">رائد</option>
          <option value="<@&1271924904530542741> <:D_:1329942880122437642>">مقدم</option>
          <option value="<@&1271924904530542743> <:jju:1329944115667931136>">عقيد</option>
          <option value="<@&1271924904572227594> <:G_:1329942871331045406>">عميد</option>
          <option value="<@&1271924904572227596> <:D_:1329942880122437642>">لواء</option>
          <option value="<@&1271924904572227598> <:S_:1329942890784493675>">فريق</option>
          <option value="<@&1271924904572227600> <:A_:1329942900976390165>">فريق أول</option>
        </select>
      </div>
      <div id="admin" class="form-section">
        <label for="telegramNumberAdmin0">رقم البرقية:</label>
        <input type="text" id="telegramNumberAdmin0" placeholder="أدخل رقم البرقية">
        <label for="userIdsAdmin0">معرفات المستخدمين (يمكن إدخال متعددة في سطور):</label>
        <textarea id="userIdsAdmin0" placeholder="أدخل المعرفات، واحد في كل سطر أو مفصولة بفواصل"></textarea>
        <label for="rankAdmin0">الرتبة:</label>
        <select id="rankAdmin0">
          <option value="">اختر رتبة</option>
          <option value="<@&1271924904509444211>">جندي</option>
          <option value="<@&1271924904509444212> <:gdgd:1329942751160307842>">جندي أول</option>
          <option value="<@&1271924904509444213> <:ggd:1329942772798722058>">عريف</option>
          <option value="<@&1271924904509444214> <:rere:1329942787248099374>">وكيل رقيب</option>
          <option value="<@&1271924904509444215> <:rq:1329942811054964759>">رقيب</option>
          <option value="<@&1271924904509444216> <:qwdq:1329942825038778498>">رقيب أول</option>
          <option value="<@&1271924904530542735> <:jjj:1329944131224735804>">رئيس رقباء</option>
          <option value="<@&1271924904530542736> <:ggy:1329944091873640520>">ملازم</option>
          <option value="<@&1271924904530542737> <:hnn:1329944105861513226>">ملازم أول</option>
          <option value="<@&1271924904530542738> <:N_:1329942837856305252>">نقيب</option>
          <option value="<@&1271924904530542739> <:K_:1329942847893409925>">رائد</option>
          <option value="<@&1271924904530542741> <:D_:1329942880122437642>">مقدم</option>
          <option value="<@&1271924904530542743> <:jju:1329944115667931136>">عقيد</option>
          <option value="<@&1271924904572227594> <:G_:1329942871331045406>">عميد</option>
          <option value="<@&1271924904572227596> <:D_:1329942880122437642>">لواء</option>
          <option value="<@&1271924904572227598> <:S_:1329942890784493675>">فريق</option>
          <option value="<@&1271924904572227600> <:A_:1329942900976390165>">فريق أول</option>
        </select>
      </div>
      <div id="military" class="form-section">
        <label for="telegramNumberMilitary0">رقم البرقية:</label>
        <input type="text" id="telegramNumberMilitary0" placeholder="أدخل رقم البرقية">
        <label for="userIdsMilitary0">معرفات المستخدمين (يمكن إدخال متعددة في سطور):</label>
        <textarea id="userIdsMilitary0" placeholder="أدخل المعرفات، واحد في كل سطر أو مفصولة بفواصل"></textarea>
        <label for="rankMilitary0">الرتبة:</label>
        <select id="rankMilitary0">
          <option value="">اختر رتبة</option>
          <option value="<@&1271924904509444211>">جندي</option>
          <option value="<@&1271924904509444212> <:gdgd:1329942751160307842>">جندي أول</option>
          <option value="<@&1271924904509444213> <:ggd:1329942772798722058>">عريف</option>
          <option value="<@&1271924904509444214> <:rere:1329942787248099374>">وكيل رقيب</option>
          <option value="<@&1271924904509444215> <:rq:1329942811054964759>">رقيب</option>
          <option value="<@&1271924904509444216> <:qwdq:1329942825038778498>">رقيب أول</option>
          <option value="<@&1271924904530542735> <:jjj:1329944131224735804>">رئيس رقباء</option>
          <option value="<@&1271924904530542736> <:ggy:1329944091873640520>">ملازم</option>
          <option value="<@&1271924904530542737> <:hnn:1329944105861513226>">ملازم أول</option>
          <option value="<@&1271924904530542738> <:N_:1329942837856305252>">نقيب</option>
          <option value="<@&1271924904530542739> <:K_:1329942847893409925>">رائد</option>
          <option value="<@&1271924904530542741> <:D_:1329942880122437642>">مقدم</option>
          <option value="<@&1271924904530542743> <:jju:1329944115667931136>">عقيد</option>
          <option value="<@&1271924904572227594> <:G_:1329942871331045406>">عميد</option>
          <option value="<@&1271924904572227596> <:D_:1329942880122437642>">لواء</option>
          <option value="<@&1271924904572227598> <:S_:1329942890784493675>">فريق</option>
          <option value="<@&1271924904572227600> <:A_:1329942900976390165>">فريق أول</option>
        </select>
      </div>
      <div id="authorized" class="form-section">
        <label for="telegramNumberAuthorized0">رقم البرقية:</label>
        <input type="text" id="telegramNumberAuthorized0" placeholder="أدخل رقم البرقية">
        <label for="userIdsAuthorized0">معرفات المستخدمين (يمكن إدخال متعددة في سطور):</label>
        <textarea id="userIdsAuthorized0" placeholder="أدخل المعرفات، واحد في كل سطر أو مفصولة بفواصل"></textarea>
        <label for="rankAuthorized0">الرتبة:</label>
        <select id="rankAuthorized0">
          <option value="">اختر رتبة</option>
          <option value="<@&1271924904509444211>">جندي</option>
          <option value="<@&1271924904509444212> <:gdgd:1329942751160307842>">جندي أول</option>
          <option value="<@&1271924904509444213> <:ggd:1329942772798722058>">عريف</option>
          <option value="<@&1271924904509444214> <:rere:1329942787248099374>">وكيل رقيب</option>
          <option value="<@&1271924904509444215> <:rq:1329942811054964759>">رقيب</option>
          <option value="<@&1271924904509444216> <:qwdq:1329942825038778498>">رقيب أول</option>
          <option value="<@&1271924904530542735> <:jjj:1329944131224735804>">رئيس رقباء</option>
          <option value="<@&1271924904530542736> <:ggy:1329944091873640520>">ملازم</option>
          <option value="<@&1271924904530542737> <:hnn:1329944105861513226>">ملازم أول</option>
          <option value="<@&1271924904530542738> <:N_:1329942837856305252>">نقيب</option>
          <option value="<@&1271924904530542739> <:K_:1329942847893409925>">رائد</option>
          <option value="<@&1271924904530542741> <:D_:1329942880122437642>">مقدم</option>
          <option value="<@&1271924904530542743> <:jju:1329944115667931136>">عقيد</option>
          <option value="<@&1271924904572227594> <:G_:1329942871331045406>">عميد</option>
          <option value="<@&1271924904572227596> <:D_:1329942880122437642>">لواء</option>
          <option value="<@&1271924904572227598> <:S_:1329942890784493675>">فريق</option>
          <option value="<@&1271924904572227600> <:A_:1329942900976390165>">فريق أول</option>
        </select>
      </div>
      <div id="reassignment" class="form-section">
        <label for="telegramNumberReassignment0">رقم البرقية:</label>
        <input type="text" id="telegramNumberReassignment0" placeholder="أدخل رقم البرقية">
        <label for="userIdsReassignment0">معرفات المستخدمين (يمكن إدخال متعددة في سطور):</label>
        <textarea id="userIdsReassignment0" placeholder="أدخل المعرفات، واحد في كل سطر أو مفصولة بفواصل"></textarea>
        <label for="rankReassignment0">الرتبة:</label>
        <select id="rankReassignment0">
          <option value="">اختر رتبة</option>
          <option value="<@&1271924904509444211>">جندي</option>
          <option value="<@&1271924904509444212> <:gdgd:1329942751160307842>">جندي أول</option>
          <option value="<@&1271924904509444213> <:ggd:1329942772798722058>">عريف</option>
          <option value="<@&1271924904509444214> <:rere:1329942787248099374>">وكيل رقيب</option>
          <option value="<@&1271924904509444215> <:rq:1329942811054964759>">رقيب</option>
          <option value="<@&1271924904509444216> <:qwdq:1329942825038778498>">رقيب أول</option>
          <option value="<@&1271924904530542735> <:jjj:1329944131224735804>">رئيس رقباء</option>
          <option value="<@&1271924904530542736> <:ggy:1329944091873640520>">ملازم</option>
          <option value="<@&1271924904530542737> <:hnn:1329944105861513226>">ملازم أول</option>
          <option value="<@&1271924904530542738> <:N_:1329942837856305252>">نقيب</option>
          <option value="<@&1271924904530542739> <:K_:1329942847893409925>">رائد</option>
          <option value="<@&1271924904530542741> <:D_:1329942880122437642>">مقدم</option>
          <option value="<@&1271924904530542743> <:jju:1329944115667931136>">عقيد</option>
          <option value="<@&1271924904572227594> <:G_:1329942871331045406>">عميد</option>
          <option value="<@&1271924904572227596> <:D_:1329942880122437642>">لواء</option>
          <option value="<@&1271924904572227598> <:S_:1329942890784493675>">فريق</option>
          <option value="<@&1271924904572227600> <:A_:1329942900976390165>">فريق أول</option>
        </select>
      </div>
      <button onclick="generateAndCopy()">نسخ النموذج</button>
    </div>
  </div>
  <script>
    var gk_isXlsx = false;
    var gk_xlsxFileLookup = {};
    var gk_fileData = {};
    function filledCell(cell) {
      return cell !== '' && cell != null;
    }
    function loadFileData(filename) {
      if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
        try {
          var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
          var firstSheetName = workbook.SheetNames[0];
          var worksheet = workbook.Sheets[firstSheetName];
          var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
          var filteredData = jsonData.filter(row => row.some(filledCell));
          var headerRowIndex = filteredData.findIndex((row, index) =>
            row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
          );
          if (headerRowIndex === -1 || headerRowIndex > 25) {
            headerRowIndex = 0;
          }
          var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex));
          csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
          return csv;
        } catch (e) {
          console.error(e);
          return "";
        }
      }
      return gk_fileData[filename] || "";
    }

    function toggleForm() {
      const formType = document.getElementById('formType').value;
      const container = document.getElementById('container');
      const promotionDiv = document.getElementById('promotion');
      const gseDiv = document.getElementById('gse');
      const adminDiv = document.getElementById('admin');
      const militaryDiv = document.getElementById('military');
      const authorizedDiv = document.getElementById('authorized');
      const reassignmentDiv = document.getElementById('reassignment');

      if (container) {
        container.style.display = formType ? 'block' : 'none';
        promotionDiv.classList.toggle('active', formType === 'promotion');
        gseDiv.classList.toggle('active', formType === 'gse');
        adminDiv.classList.toggle('active', formType === 'admin');
        militaryDiv.classList.toggle('active', formType === 'military');
        authorizedDiv.classList.toggle('active', formType === 'authorized');
        reassignmentDiv.classList.toggle('active', formType === 'reassignment');
      } else {
        console.error("Element with id 'container' not found.");
      }
    }

    let personCount = 1;
    function addPerson() {
      personCount++;
      const personGroup = document.createElement('div');
      personGroup.className = 'person-group';
      personGroup.id = `personGroup${personCount}`;
      personGroup.innerHTML = `
        <label for="userIds0_${personCount}">معرفات المستخدمين (يمكن إدخال متعددة في سطور):</label>
        <textarea id="userIds0_${personCount}" placeholder="أدخل المعرفات، واحد في كل سطر أو مفصولة بفواصل"></textarea>
        <label for="rankOld0_${personCount}">الرتبة السابقة:</label>
        <select id="rankOld0_${personCount}">
          <option value="">اختر رتبة</option>
          <option value="<@&1271924904509444211>">جندي</option>
          <option value="<@&1271924904509444212> <:gdgd:1329942751160307842>">جندي أول</option>
          <option value="<@&1271924904509444213> <:ggd:1329942772798722058>">عريف</option>
          <option value="<@&1271924904509444214> <:rere:1329942787248099374>">وكيل رقيب</option>
          <option value="<@&1271924904509444215> <:rq:1329942811054964759>">رقيب</option>
          <option value="<@&1271924904509444216> <:qwdq:1329942825038778498>">رقيب أول</option>
          <option value="<@&1271924904530542735> <:jjj:1329944131224735804>">رئيس رقباء</option>
          <option value="<@&1271924904530542736> <:ggy:1329944091873640520>">ملازم</option>
          <option value="<@&1271924904530542737> <:hnn:1329944105861513226>">ملازم أول</option>
          <option value="<@&1271924904530542738> <:N_:1329942837856305252>">نقيب</option>
          <option value="<@&1271924904530542739> <:K_:1329942847893409925>">رائد</option>
          <option value="<@&1271924904530542741> <:D_:1329942880122437642>">مقدم</option>
          <option value="<@&1271924904530542743> <:jju:1329944115667931136>">عقيد</option>
          <option value="<@&1271924904572227594> <:G_:1329942871331045406>">عميد</option>
          <option value="<@&1271924904572227596> <:D_:1329942880122437642>">لواء</option>
          <option value="<@&1271924904572227598> <:S_:1329942890784493675>">فريق</option>
          <option value="<@&1271924904572227600> <:A_:1329942900976390165>">فريق أول</option>
        </select>
        <label for="rankNew0_${personCount}">الرتبة الجديدة:</label>
        <select id="rankNew0_${personCount}">
          <option value="">اختر رتبة</option>
          <option value="<@&1271924904509444211>">جندي</option>
          <option value="<@&1271924904509444212> <:gdgd:1329942751160307842>">جندي أول</option>
          <option value="<@&1271924904509444213> <:ggd:1329942772798722058>">عريف</option>
          <option value="<@&1271924904509444214> <:rere:1329942787248099374>">وكيل رقيب</option>
          <option value="<@&1271924904509444215> <:rq:1329942811054964759>">رقيب</option>
          <option value="<@&1271924904509444216> <:qwdq:1329942825038778498>">رقيب أول</option>
          <option value="<@&1271924904530542735> <:jjj:1329944131224735804>">رئيس رقباء</option>
          <option value="<@&1271924904530542736> <:ggy:1329944091873640520>">ملازم</option>
          <option value="<@&1271924904530542737> <:hnn:1329944105861513226>">ملازم أول</option>
          <option value="<@&1271924904530542738> <:N_:1329942837856305252>">نقيب</option>
          <option value="<@&1271924904530542739> <:K_:1329942847893409925>">رائد</option>
          <option value="<@&1271924904530542741> <:D_:1329942880122437642>">مقدم</option>
          <option value="<@&1271924904530542743> <:jju:1329944115667931136>">عقيد</option>
          <option value="<@&1271924904572227594> <:G_:1329942871331045406>">عميد</option>
          <option value="<@&1271924904572227596> <:D_:1329942880122437642>">لواء</option>
          <option value="<@&1271924904572227598> <:S_:1329942890784493675>">فريق</option>
          <option value="<@&1271924904572227600> <:A_:1329942900976390165>">فريق أول</option>
        </select>
        <button class="remove-person" onclick="removePerson(${personCount})">حذف</button>
      `;
      document.getElementById('promotion').insertBefore(personGroup, document.querySelector('#promotion .add-person'));
    }

    function removePerson(index) {
      const personGroup = document.getElementById(`personGroup${index}`);
      if (personGroup) {
        personGroup.remove();
      }
    }

    function generateAndCopy() {
      const formType = document.getElementById('formType').value;
      const issuer = document.getElementById('issuer').value;
      let outputText = '';

      if (!issuer) {
        showNotification('يرجى اختيار القائد!', 'error');
        return;
      }

      const [issuerName, issuerMention, issuerPrefix, issuerAfterSader, issuerAfterAl] = issuer.split('|');

      if (formType === 'promotion') {
        const telegramNumber = document.getElementById('telegramNumber0').value || 'غير محدد';
        const promotionType = document.getElementById('promotionType0').value || 'الترقيات المستحقة';
        let promotions = [];

        for (let i = 0; i <= personCount; i++) {
          const userIdsInput = document.getElementById(`userIds0_${i}`)?.value;
          const rankOld = document.getElementById(`rankOld0_${i}`)?.value;
          const rankNew = document.getElementById(`rankNew0_${i}`)?.value;

          if (userIdsInput && rankOld && rankNew) {
            const userIdsRaw = userIdsInput.split(/\n|,/).map(id => id.trim()).filter(id => id);
            const userIds = userIdsRaw.map(id => `<@${id}>`);
            const mentions = userIds.join('\n\n');
            promotions.push(`من رتبة ${rankOld} إلى رتبة ${rankNew}\n\n${mentions}\n\n`);
          }
        }

        if (promotions.length > 0) {
          outputText = `
**﷽

صــادر:${issuerPrefix}${issuerAfterSader}
-
الـ ${issuerAfterAl}

\`برقية رقم: ${telegramNumber}\`

\`الموضوع: ${promotionType}\`

يتم ترقية العسكريين المذكورين أدناه:

${promotions.join('\n')}

وفقكم الله وجعلها عونًا لكم لـ خدمة القطاع والمدينة

ترسل نسخة لـ <@&1271924904467628180>

\`\`\`diff
+ في الختام نسأل الله العزيز الحكيم التوفيق والسداد
\`\`\`

توقيع واعتماد:
<@&1271924904593330267>
<@1276531558798327859> <:__:1331348769610141839>

<@&1271924904572227603>
<@725655535172714608> <:__:1331348769610141839>**`;
        } else {
          showNotification('يرجى تعبئة بيانات الترقية!', 'error');
          return;
        }
      } else if (formType === 'gse') {
        const telegramNumber = document.getElementById('telegramNumberGSE0').value || '000';
        const batchNumber = document.getElementById('batchNumber0').value || '';
        const userIdsInput = document.getElementById('userIdsGSE0')?.value;
        const rank = document.getElementById('rankGSE0')?.value;
        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const day = String(today.getDate()).padStart(2, '0');
        const startDate = `${year}/${month}/${day}`;

        if (!userIdsInput || !rank) {
          showNotification('يرجى تعبئة بيانات التوظيف!', 'error');
          return;
        }

        const userIdsRaw = userIdsInput.split(/\n|,/).map(id => id.trim()).filter(id => id);
        const userIds = userIdsRaw.map(id => `<@${id}>`);
        const mentions = userIds.join('\n');

        outputText = `
**﷽

صــادر:${issuerPrefix}${issuerAfterSader}
-
الـ ${issuerAfterAl}

\`برقية رقم: ${telegramNumber}\`

\`تم اعتماد توظيف دفعة رقم (${batchNumber}) من منسوبي الأمن العام، وعليه يلتحق الأفراد المعتمد توظيفهم ابتداءً من تاريخ: ${startDate}\`

\`على جميع المقبولين مراجعة القوانين والالتزام بالتعليمات والأنظمة العسكرية المعمول بها.\`

وبناءً على ذلك يتم توظيف المذكورين أدناه بـ رتبة ${rank} :

${mentions}

ترسل نسخة إلى مدير مكتب<@&1271924904467628180>الادارية لإعتماد القرار

\`\`\`diff
+ في الختام سائلين الله لهم التوفيق والسداد
\`\`\`

توقيع وإعتماد :
<@&1271924904593330267>
<@1276531558798327859> <:__:1331348769610141839>

<@&1271924904572227603>
<@725655535172714608> <:__:1331348769610141839>**`;
      } else if (formType === 'admin') {
        const telegramNumber = document.getElementById('telegramNumberAdmin0').value || 'غير محدد';
        const userIdsInput = document.getElementById('userIdsAdmin0')?.value;
        const rank = document.getElementById('rankAdmin0')?.value;

        if (userIdsInput && rank) {
          const userIdsRaw = userIdsInput.split(/\n|,/).map(id => id.trim()).filter(id => id);
          const userIds = userIdsRaw.map(id => `<@${id}>`);
          const mentions = userIds.join('\n\n');
          const assignmentList = `يتم تعيين المذكور أدناه:\n\n${mentions}\n\nبرتبة: ${rank}\n\n`;

          outputText = `
**﷽

صــادر:${issuerPrefix}${issuerAfterSader}
-
الـ ${issuerAfterAl}

\`برقية رقم: ${telegramNumber}\`

\`الموضوع: تعيين إداري\`

${assignmentList}

وفقكم الله وجعلها عونًا لكم لـ خدمة القطاع والمدينة

ترسل نسخة لـ <@&1271924904467628180>

\`\`\`diff
+ في الختام نسأل الله العزيز الحكيم التوفيق والسداد
\`\`\`

توقيع واعتماد:
<@&1271924904593330267>
<@1276531558798327859> <:__:1331348769610141839>

<@&1271924904572227603>
<@725655535172714608> <:__:1331348769610141839>**`;
        } else {
          showNotification('يرجى تعبئة بيانات التعيين الإداري!', 'error');
          return;
        }
      } else if (formType === 'military') {
        const telegramNumber = document.getElementById('telegramNumberMilitary0').value || 'غير محدد';
        const userIdsInput = document.getElementById('userIdsMilitary0')?.value;
        const rank = document.getElementById('rankMilitary0')?.value;

        if (userIdsInput && rank) {
          const userIdsRaw = userIdsInput.split(/\n|,/).map(id => id.trim()).filter(id => id);
          const userIds = userIdsRaw.map(id => `<@${id}>`);
          const mentions = userIds.join('\n\n');
          const assignmentList = `يتم تعيين المذكور أدناه:\n\n${mentions}\n\nبرتبة: ${rank}\n\n`;

          outputText = `
**﷽

صــادر:${issuerPrefix}${issuerAfterSader}
-
الـ ${issuerAfterAl}

\`برقية رقم: ${telegramNumber}\`

\`الموضوع: تعيين عسكري\`

${assignmentList}

وفقكم الله وجعلها عونًا لكم لـ خدمة القطاع والمدينة

ترسل نسخة لـ <@&1271924904467628180>

\`\`\`diff
+ في الختام نسأل الله العزيز الحكيم التوفيق والسداد
\`\`\`

توقيع واعتماد:
<@&1271924904593330267>
<@1276531558798327859> <:__:1331348769610141839>

<@&1271924904572227603>
<@725655535172714608> <:__:1331348769610141839>**`;
        } else {
          showNotification('يرجى تعبئة بيانات التعيين العسكري!', 'error');
          return;
        }
      } else if (formType === 'authorized') {
        const telegramNumber = document.getElementById('telegramNumberAuthorized0').value || 'غير محدد';
        const userIdsInput = document.getElementById('userIdsAuthorized0')?.value;
        const rank = document.getElementById('rankAuthorized0')?.value;

        if (userIdsInput && rank) {
          const userIdsRaw = userIdsInput.split(/\n|,/).map(id => id.trim()).filter(id => id);
          const userIds = userIdsRaw.map(id => `<@${id}>`);
          const mentions = userIds.join('\n\n');
          const assignmentList = `يتم تعيين المذكور أدناه:\n\n${mentions}\n\nبرتبة: ${rank}\n\n`;

          outputText = `
**﷽

صــادر:${issuerPrefix}${issuerAfterSader}
-
الـ ${issuerAfterAl}

\`برقية رقم: ${telegramNumber}\`

\`الموضوع: تعيين معتمد\`

${assignmentList}

وفقكم الله وجعلها عونًا لكم لـ خدمة القطاع والمدينة

ترسل نسخة لـ <@&1271924904467628180>

\`\`\`diff
+ في الختام نسأل الله العزيز الحكيم التوفيق والسداد
\`\`\`

توقيع واعتماد:
<@&1271924904593330267>
<@1276531558798327859> <:__:1331348769610141839>

<@&1271924904572227603>
<@725655535172714608> <:__:1331348769610141839>**`;
        } else {
          showNotification('يرجى تعبئة بيانات التعيين المعتمد!', 'error');
          return;
        }
      } else if (formType === 'reassignment') {
        const telegramNumber = document.getElementById('telegramNumberReassignment0').value || 'غير محدد';
        const userIdsInput = document.getElementById('userIdsReassignment0')?.value;
        const rank = document.getElementById('rankReassignment0')?.value;

        if (userIdsInput && rank) {
          const userIdsRaw = userIdsInput.split(/\n|,/).map(id => id.trim()).filter(id => id);
          const userIds = userIdsRaw.map(id => `<@${id}>`);
          const mentions = userIds.join('\n\n');
          const reassignmentList = `يتم إعادة العسكري المذكور أدناه إلى الخدمة:\n\n${mentions}\n\nبرتبة: ${rank}\n\n`;

          outputText = `
**﷽

صــادر:${issuerPrefix}${issuerAfterSader}
-
الـ ${issuerAfterAl}

\`برقية رقم: ${telegramNumber}\`

\`الموضوع: إعادة الخدمة\`

${reassignmentList}

وفقكم الله وجعلها عونًا لكم لـ خدمة القطاع والمدينة

ترسل نسخة لـ <@&1271924904467628180>

\`\`\`diff
+ في الختام نسأل الله العزيز الحكيم التوفيق والسداد
\`\`\`

توقيع واعتماد:
<@&1271924904593330267>
<@1276531558798327859> <:__:1331348769610141839>

<@&1271924904572227603>
<@725655535172714608> <:__:1331348769610141839>**`;
        } else {
          showNotification('يرجى تعبئة بيانات إعادة الخدمة!', 'error');
          return;
        }
      }

      navigator.clipboard.writeText(outputText).then(() => {
        showNotification('تم النسخ بنجاح', 'success');
      }).catch(() => {
        showNotification('فشل النسخ', 'error');
      });
    }

    function showNotification(message, type) {
      const notification = document.getElementById('notification');
      notification.innerText = message;
      notification.className = `custom-alert ${type} show`;
      setTimeout(() => {
        notification.className = 'custom-alert';
      }, 3000);
    }

    // Starfield Animation
    const canvas = document.getElementById('starfield');
    const ctx = canvas.getContext('2d');
    let stars = [];

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    function createStar() {
      return {
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        radius: Math.random() * 1 + 0.3,
        speed: Math.random() * 0.3 + 0.1,
        opacity: Math.random() * 0.7 + 0.3
      };
    }

    function initStars() {
      stars = [];
      for (let i = 0; i < 150; i++) {
        stars.push(createStar());
      }
    }

    function animateStars() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      stars.forEach(star => {
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255, 255, 255, ${star.opacity})`;
        ctx.fill();
        star.y += star.speed;
        if (star.y > canvas.height) {
          star.y = 0;
          star.x = Math.random() * canvas.width;
        }
      });
      requestAnimationFrame(animateStars);
    }

    initStars();
    animateStars();

    // Loading Animation
    window.addEventListener('load', () => {
      setTimeout(() => {
        const loadingOverlay = document.getElementById('loadingOverlay');
        loadingOverlay.classList.add('fade-out');
      }, 1200);
    });
  </script>
</body>
</html>
